//animations
function BattleView() {}

BattleView.prototype = {
  updateView: function( data ) {
    // targetIsSelf: The target of the attack is the client (true) or the client's opponent (false)
    // attackType: The attack should be animated (e.g. tackle, counter)
    this.animateAttack({ targetIsSelf: data.targetIsSelf, attackType: data.attackType })
    
    this.updateHealthBar( data );
  },
  pokemonFaints: function( targetIsSelf ) {
    if ( targetIsSelf ) {
      var $pokemon = $( '.my-pokemon img' );
      var faintAnimation = 'myPokeFaint';
    } else {
      var $pokemon = $( '.their-pokemon img' );
      var faintAnimation = 'theirPokeFaint';
    }

    $pokemon.addClass( faintAnimation );
    this.playSound( 'faint' );
  }
  updateHealthBar: function( attributes ){
    var updateTarget = attributes.targetIsSelf ? '.my-healthbar' : '.their-healthbar';
    $( updateTarget ).val( attributes.health / attributes.maxHealth * 100 );
  },
  animateAttack: function( attributes ){
    var attackAnimateClass = 'animated'; // Attack animation class using Animate.CSS

    if ( attributes.targetIsSelf ) {
      var $attackingPokemon = $( '.their-pokemon' );
      var $targetPokemon = $( '.my-pokemon' );
    } else {
      var $attackingPokemon = $( '.my-pokemon' );
      var $targetPokemon = $( '.their-pokemon' );
    }

    // Plays the appropriate sound for the appropriate attackType
    this.playSound( attributes.attackType );

    // Animate the pokemon for the appropriate attackType
    this.animatePokemon.call( $attackingPokemon, attributes.attackType );
    this.animatePokemon.call( $targetPokemon, 'receive-damage' );
  },
  animatePokemon: function( attackType ) {
    var animationClass = 'animated ' + attackType;
    var $pokemon = $( this );

    // Add animation class
    $pokemon.addClass( animationClass );

    // After animation is over, reset the pokemon's state
    $pokemon.one('webkitAnimationEnd mozAnimationEnd', function() {
      $( this ).removeClass( animationClass );
    });
  },
  playSound: function( id ) {
    // Finds the appropriate audio tag and plays it
    document.getElementById( 'audio-' + id ).play();
  }
};
